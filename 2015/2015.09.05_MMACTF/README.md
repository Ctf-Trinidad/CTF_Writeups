# Hackcon 2015: I'd love to turn you on

**Category:** Crypto
**Points:** 10
**Link:** http://score.mmactf.link/problems/3?locale=en
**Difficulty:** WarmUp (easiest)

**Description:** [Flag01]

The flag is in all uppercase letters without spaces.

This is a crypto challenge. Only the highlighted parts are important to get to know what you have to do. What you have to do it on, is the name of the song.

## Write-up

Link http://uecmma.github.io/mmactf/

Smart Cipher System 
Decrypt 4 flags.

ФЛАГ 1 (10 очков)
36 36 2a 64 4b 4b 4a 21 1e 4b 1f 20 1f 21 4d 4b 1b 1d 19 4f 21 4c 1d 4a 4e 1c 4c 1b 22 4f 22 22 1b 21 4c 20 1d 4f 1f 4c 4a 19 22 1a 66
http://bow.chal.mmactf.link/~scs/crypt2.cgi
Здесь все просто. Все флаги начинаются с MMA{ Видим, что 36 36 2a 64 соотвествует паттерну.
Проверям с 1111. Получаем на выходе 1a 1a 1a 1a. Значит никаких сдвигов нет в зависимости от позции нет.
В шестнадцатеричной системе код 1 = 31. Берем калькулятор, 31-1a=17. Сдвиг равен 17. 
Открываем Winhex (ну или что удобнее и где можно прибавить 17 в HEX) и прибавляем к
36 36 2a 64 4b 4b 4a 21 1e 4b 1f 20 1f 21 4d 4b 1b 1d 19 4f 21 4c 1d 4a 4e 1c 4c 1b 22 4f 22 22 1b 21 4c 20 1d 4f 1f 4c 4a 19 22 1a 66
17 (Edit->Modify Data->Add 17 (check hexadec.)) и получаем первый флаг
MMA{bba85b6768db240f8c4ae3c29f9928c74f6ca091}
В общем имеем шифр Цезаря.
**Description:** [Flag01]
ФЛАГ 2 (10 очков)
e3 e3 83 21 33 96 23 43 ef 9a 9a 05 18 c7 23 07 07 07 c7 9a 04 33 23 07 23 ef 12 c7 04 96 43 23 23 18 04 04 05 c7 fb 18 96 43 ef 43 ff
http://bow.chal.mmactf.link/~scs/crypt4.cgi
Здесь пришлось делать все руками, т.к. выявить закономерность с нахрапу не удалось. Единственно, что было понятно, что также нет зависимости от позиции.
Забиваем алфавит, получаем таблицу (по факту достаточно abcdef0123456789)
a	b	c	d	e	f	g	h	i	j	k	l	m	n	o	p	q	r	s	t	u	v	w	x	y	z	0	1	2	3	4	5	6	7	8	9
ef	aa	fb	43	4d	33	85	45	f9	02	7f	50	3c	9f	a8	51	a3	40	8f	92	9d	38	f5	bc	b6	da	04	c7	23	c3	18	96	05	9a	07	12
Делаем замену
e3	e3	83	21	33	96	23	43	ef	9a	9a	05	18	c7	23	07	07	07	c7	9a	04	33	23	07	23	ef	12	c7	04	96	43	23	23	18	04	04	05	c7	fb	18	96	43	ef	43	ff
M	M	A	{	f	5	2	d	a	7	7	6	4	1	2	8	8	8	1	7	0	f	2	8	2	a	9	1	0	5	d	2	2	4	0	0	6	1	c	4	5	d	a	d	}
Получаем флаг
MMA{f52da776412888170f282a9105d2240061c45dad}
Здесь шифр простой замены.

ФЛАГ 3 (30 очков)
60 00 0c 3a 1e 52 02 53 02 51 0c 5d 56 51 5a 5f 5f 5a 51 00 05 53 56 0a 5e 00 52 05 03 51 50 55 03 04 52 04 0f 0f 54 52 57 03 52 04 4e
http://bow.chal.mmactf.link/~scs/crypt5.cgi
Долго мучался, т.к. пытался выяснить каким образом вычисляется первое значение. Зря потерял время, т.к. введя предыдущий флаг
MMA{f52da776412888170f282a9105d2240061c45dad}
получил такое же начальное значение. 
60 00 0c 3a 1d 53 07 56 05 56 00 01 02 05 03 0a 00 00 09 06 07 56 54 0a 0a 53 58 08 01 05 51 56 00 06 04 00 06 07 52 57 01 51 05 05 19
Т.е. первое значение это длина (как вычисляется не знаю), теперь надо понять каким образом формируются остальные числа. Посмотрим, что мы получаем при вводе разных данных:
111111 = 37 00 00 00 00 00. 37 длина
111112 = 37 00 00 00 00 03
111122 = 37 00 00 00 03 00
Это похоже на XOR. Вроде как ответ = значение XOR предыдущее значение. Проверяем 31 XOR 32 (1 и 2 в HEX) и получаем в 03(HEX). Берем известную последовательность:
4D 4D 41 7B = MMA{
60 00 0c 3a - 60 это длина. Для получения 0с необходимо 41 XOR 4D. 3a = 41 XOR 7B. Мы знаем, что последний знак флага это } = 7D
7D xor 19 = 64(hex) = d (dec)
scripts/flag03.sh - антиXOR
scripts/list03.txt - значение в обратном порядке
MMA{f52da776412888170f282a9105d2240061c45dad}
Тут немного сложнее и путанница была в первом числе. Итого это XOR с предыдущим числом. Первое значение - длина флага.
